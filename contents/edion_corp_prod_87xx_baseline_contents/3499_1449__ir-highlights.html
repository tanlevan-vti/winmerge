<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.14.2/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.min.js"></script>
<p><select id="pulldown" onchange="drawChart()">
    <option>第１四半期</option>
    <option>第２四半期</option>
    <option>第３四半期</option>
    <option selected="selected">第４四半期</option>
  </select>
  <script type="text/javascript">


    google.charts.load('current', { 'packages': ['corechart'] });
    google.charts.setOnLoadCallback(drawChart);


    var array1 =//第１四半期データ
      [
        ['第１四半期', '売上高', '売上総利益', '売上総利益率', '営業利益', '経常利益', '当期利益', '総資産', '純資産', 'ROE', 'ROIC', 'ROA', '自己資本比率', 'EPS', 'BPS', '中間', '期末', '記念', '配当性向'],
        ['2002', 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 0.0, 0.0, 0.00, 0.00, 0.00, 0.00, 0.00, 0],
        ['2002', null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null],
        ['2003', 99500, 20692, 20.8, -1246, -2, 32, null, null, null, null, null, null, null, null, null, null, null, null],
        ['2004', 99493, 21740, 21.8, -2739, -1335, -889, 241497, 92823, null, null, null, 38.5, -11.37, 1186.14, null, null, null, null],
        ['2005', 160950, 36326, 22.6, -2630, 319, -1096, 322706, 119707, null, null, null, 37.1, -10.81, 1133.30, null, null, null, null],
        ['2006', 166562, 36437, 21.9, -3560, -707, -724, 334027, 127454, null, null, null, 38.2, -6.86, 1206.76, null, null, null, null],
        ['2007', 177491, 39727, 22.38, -3160, -289, -548, 413027, 159905, null, null, null, 31.8, -5.19, 1244.94, null, null, null, null],
        ['2008', 183714, 42278, 23.01, -4726, -1856, -2445, 430630, 155607, null, null, null, 30.6, -23.15, 1247.51, null, null, null, null],
        ['2009', 178000, 41663, 23.4, -3427, -839, -2470, 401677, 133539, null, null, null, 29.6, -23.40, 1127.25, null, null, null, null],
        ['2010', 185025, 44814, 24.22, -1379, 171, -3153, 403180, 141642, null, null, null, 30.3, -30.56, 1192.80, null, null, null, null],
        ['2011', 191927, 47640, 24.82, 1721, 3590, 2624, 416230, 157123, null, null, null, 34.2, 25.58, null, null, null, null, null],
        ['2012', 155017, 38253, 24.67, -6169, -5133, -3497, 368435, 138860, null, null, null, 37.6, -33.78, null, null, null, null, null],
        ['2013', 160836, 41445, 25.76, -2981, -2297, -1328, 376888, 136008, null, null, null, 36.0, -13.08, null, null, null, null, null],
        ['2014', 156347, 43848, 27.81, 354, 588, 614, 372314, 146367, null, null, null, 39.2, 5.56, null, null, null, null, null],
        ['2015', 153527, 44152, 28.75, 530, 556, 271, 368953, 142605, null, null, null, 38.6, 2.61, 1392.89, null, null, null, null],
        ['2016', 153113, 44860, 29.29, 1090, 1345, 697, 370783, 141356, null, null, null, 38.1, 7.07, 1431.43, null, null, null, null],
        ['2017', 150022, 44294, 29.53, 132, 317, 99, 377723, 147899, null, null, null, 39.2, 1.04, 1557.87, null, null, null, null],
        ['2018', 157154, 47301, 30.1, 1090, 1391, 652, 377644, 167890, null, null, null, 44.5, 5.93, 1525.74, null, null, null, null],
        ['2019', 170742, 50749, 29.72, -2898, -2679, -2109, 386164, 173964, null, null, null, 45.0, -18.97, 1563.73, null, null, null, null],
        ['2020', 175304, 52765, 30.1, 5536, 5461, 3049, 384170, 181826, null, null, null, 47.3, 28.50, 1698.82, null, null, null, null],
        ['2021', 165081, 50122, 30.36, 2456, 2583, 1737, 381802, 195299, null, null, null, 51.2, 16.21, 1821.71, null, null, null, null],
        ['2022', 164854, 50634, 30.71, 3121, 2973, 2171, 385307, 199445, null, null, null, 51.8, 21.22, 1949.78, null, null, null, null],
        ['2023', 160941, 48498, 30.13, 1771, 1893, 1093, 376951, 200888, null, null, null, 53.3, 11.11, 2040.81, null, null, null, null],
        ['2024', 174457, 52270, 29.96, 3342, 3647, 2280, 440594, 215042, null, null, null, 48.7, 21.70, 2043.26, null, null, null, null]
      ];
    var array2 =//第２四半期データ
      [
        ['第２四半期', '売上高', '売上総利益', '売上総利益率', '営業利益', '経常利益', '当期利益', '総資産', '純資産', 'ROE', 'ROIC', 'ROA', '自己資本比率', 'EPS', 'BPS', '中間', '期末', '記念', '配当性向'],
        ['2002', 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 0.0, 0.0, 0.00, 0.00, 0.00, 0.00, 0.00, 0],
        ['2002', null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null],
        ['2003', 214381, 45855, 21.4, 2745, 5043, 2098, 229269, 94182, null, null, null, 41.1, 26.81, 1203.54, null, null, null, null],
        ['2004', 215553, 47650, 22.1, 1233, 4599, 1906, 223995, 95329, null, null, null, 42.6, 24.33, 1215.09, null, null, null, null],
        ['2005', 349227, 77657, 22.2, 2930, 9190, 2943, 304962, 123940, null, null, null, 40.6, 28.51, 1173.42, null, null, null, null],
        ['2006', 362760, 81324, 22.4, 2111, 8019, 3733, 330166, 131874, null, null, null, 39.6, 35.35, 1238.46, null, null, null, null],
        ['2007', 418717, 96769, 23.1, 3929, 10289, 4289, 416740, 175945, null, null, null, 32.4, 40.62, 1278.59, null, null, null, null],
        ['2008', 403436, 95127, 23.58, 1637, 7026, 55, 417866, 158640, null, null, null, 32.4, 0.53, 40.62, null, null, null, null],
        ['2009', 391197, 94072, 24.05, 4304, 9025, 3125, 392277, 137314, null, null, null, 31.2, 29.80, 1188.35, null, null, null, null],
        ['2010', 424063, 104992, 24.76, 12660, 16232, 6128, 392904, 146488, null, null, null, 33.5, 59.47, 1287.78, null, null, null, null],
        ['2011', 406422, 101832, 25.06, 11977, 15853, 10954, 367931, 157775, null, null, null, 41.0, 106.57, null, null, null, null, null],
        ['2012', 344104, 87680, 25.48, -2743, -707, -1141, 355013, 140466, null, null, null, 39.5, -11.08, null, null, null, null, null],
        ['2013', 350077, 92627, 26.46, 2858, 3925, 2930, 351958, 145206, null, null, null, 41.2, 28.50, null, null, null, null, null],
        ['2014', 338852, 96246, 28.4, 5863, 6031, 3911, 366031, 148589, null, null, null, 40.6, 35.37, 1389.43, null, null, null, null],
        ['2015', 339761, 97923, 28.82, 8552, 8733, 5677, 362727, 144697, null, null, null, 39.9, 55.84, 1464.95, null, null, null, null],
        ['2016', 333494, 98775, 29.62, 9887, 10555, 6570, 352618, 147427, null, null, null, 41.8, 66.55, 1493.11, null, null, null, null],
        ['2017', 334713, 99373, 29.69, 9260, 9603, 6278, 368439, 154046, null, null, null, 41.8, 65.60, 1622.62, null, null, null, null],
        ['2018', 352358, 105750, 30.01, 10634, 11065, 7131, 359897, 174517, null, null, null, 48.5, 64.80, 1584.76, null, null, null, null],
        ['2019', 396736, 116695, 29.41, 10761, 11922, 9264, 370730, 180488, null, null, null, 48.7, 84.40, 1695.38, null, null, null, null],
        ['2020', 382629, 115334, 30.14, 16695, 16681, 10395, 377677, 189411, null, null, null, 50.2, 97.10, 1768.31, null, null, null, null],
        ['2021', 348768, 106114, 30.43, 10010, 11200, 7606, 362409, 198141, null, null, null, 54.7, 71.56, 1900.67, null, null, null, null],
        ['2022', 351115, 106754, 30.40, 10333, 10169, 7070, 382219, 204492, null, null, null, 53.5, 69.11, 1997.66, null, null, null, null],
        ['2023', 352577, 106544, 30.22, 10779, 11052, 7216, 369621, 207703, null, null, null, 56.1, 73.30, 2104.62, null, null, null, null],
        ['2024', 380500, 114779, 30.17, 14498, 15027, 10031, 418041, 223388, null, null, null, 53.3, 95.35, 2098.01, null, null, null, null]
      ];
    var array3 =//第３四半期データ
      [
        ['第３四半期', '売上高', '売上総利益', '売上総利益率', '営業利益', '経常利益', '当期利益', '総資産', '純資産', 'ROE', 'ROIC', 'ROA', '自己資本比率', 'EPS', 'BPS', '中間', '期末', '記念', '配当性向'],
        ['2002', 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 0.0, 0.0, 0.00, 0.00, 0.00, 0.00, 0.00, 0],
        ['2002', null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null],
        ['2003', 331214, 69613, 21.0, 4334, 7635, 3627, null, null, null, null, null, null, null, null, null, null, null, null],
        ['2004', 329829, 72009, 21.8, 2267, 6883, 3111, 252519, 95897, null, null, null, 38.0, 39.69, 1222.35, null, null, null, null],
        ['2005', 546727, 119612, 21.9, 5819, 14971, 5785, 346815, 126090, null, null, null, 36.4, 55.65, 1193.81, null, null, null, null],
        ['2006', 562252, 124231, 22.1, 3848, 12699, 5920, 373409, 132987, null, null, null, 35.3, 56.05, 1248.78, null, null, null, null],
        ['2007', 648410, 147686, 22.77, 4832, 14232, 3851, 457855, 175177, null, null, null, 29.4, 36.47, 1273.93, null, null, null, null],
        ['2008', 616648, 142372, 23.09, -456, 7547, -2113, 445110, 145967, null, null, null, 29.6, -20.02, 1245.79, null, null, null, null],
        ['2009', 613645, 145359, 23.69, 6039, 13329, 6436, 436184, 138419, null, null, null, 28.6, 61.68, 1210.05, null, null, null, null],
        ['2010', 697364, 168110, 24.11, 23791, 29660, 16379, 440248, 156026, null, null, null, 32.1, 159.26, 1377.65, null, null, null, null],
        ['2011', 591254, 145441, 24.6, 11119, 16561, 11375, 392341, 151759, null, null, null, 38.5, 110.51, null, null, null, null, null],
        ['2012', 522737, 130962, 25.05, -4464, -1553, -2367, 388311, 138557, null, null, null, 35.6, -23.08, null, null, null, null, null],
        ['2013', 546038, 140475, 25.73, 3897, 4937, 3161, 389782, 144449, null, null, null, 37.0, 30.07, null, null, null, null, null],
        ['2014', 521715, 143870, 27.58, 8331, 8480, 5112, 390684, 144943, null, null, null, 37.1, 47.02, null, null, null, null, null],
        ['2015', 522028, 148275, 28.4, 13167, 13199, 8234, 386482, 146273, null, null, null, 37.8, 81.71, 1480.99, null, null, null, null],
        ['2016', 510277, 147512, 28.91, 13022, 13736, 8802, 377934, 148983, null, null, null, 39.4, 89.15, 1508.88, null, null, null, null],
        ['2017', 515516, 150746, 29.24, 13275, 13738, 8858, 377326, 155549, null, null, null, 41.2, 92.78, 1638.46, null, null, null, null],
        ['2018', 539633, 158755, 29.42, 14499, 15189, 9656, 373907, 176205, null, null, null, 47.1, 87.54, 1583.85, null, null, null, null],
        ['2019', 568106, 164146, 28.89, 10083, 11389, 9931, 372613, 179228, null, null, null, 48.1, 91.30, 1683.56, null, null, null, null],
        ['2020', 581289, 171694, 29.54, 23026, 23469, 14688, 394980, 191585, null, null, null, 48.5, 137.18, 1788.62, null, null, null, null],
        ['2021', 528808, 157138, 29.72, 13026, 14921, 9886, 382517, 196154, null, null, null, 51.3, 93.97, 1917.60, null, null, null, null],
        ['2022', 538554, 159119, 29.55, 14216, 14000, 9382, 391922, 202710, null, null, null, 51.7, 91.92, 2012.93, null, null, null, null],
        ['2023', 537608, 156849, 29.18, 12277, 12572, 8051, 446179, 208654, null, null, null, 46.7, 81.25, 2070.59, null, null, null, null],
        ['2024', 572580, 168171, 29.37, 17871, 18507, 12293, 438555, 220891, null, null, null, 50.3, 116.26, 2099.10, null, null, null, null]
      ];
    var array4 =//第４四半期データ
      [
        ['第４四半期', '売上高', '売上総利益', '売上総利益率', '営業利益', '経常利益', '当期利益', '総資産', '純資産', 'ROE', 'ROIC', 'ROA', '自己資本比率', 'EPS', 'BPS', '中間', '期末', '記念', '配当性向'],
        ['2002', 222784, 47455, 21.3, 2533, 4445, 1214, 223757, 91885, 1.3, 1.0, 1.9, 41.1, 15.52, 1173.94, null, 10.00, null, null],
        ['2002', 220073, 46220, 21, 3260, 5020, 1176, 230332, 92259, 1.3, 3.5, 2.2, 40.1, 14.37, 1178.26, null, 10.00, null, null],
        ['2003', 434166, 92587, 21.33, 5825, 10207, 3017, 222614, 94465, 3.2, 2.8, 4.5, 42.4, 37.78, 1206.46, 10.00, 10.00, null, null],
        ['2004', 437992, 95751, 21.86, 5011, 11163, 4918, 231410, 105595, 4.9, 1.7, 4.9, 45.6, 60.58, 1185.82, 10.00, 10.00, null, null],
        ['2005', 714697, 157765, 22.07, 8054, 20389, 8226, 319507, 128504, 7.0, 2.0, 7.4, 40.2, 76.98, 1214.84, 10.00, 10.00, null, 26.0],
        ['2006', 740293, 164490, 22.22, 6946, 18631, 7367, 390550, 162176, 5.6, 1.4, 5.2, 34.0, 69.76, 1258.61, 10.00, 10.00, null, 28.7],
        ['2007', 851205, 195030, 22.91, 8480, 21227, 6754, 437410, 177576, 5.0, 1.4, 5.1, 31.2, 63.96, 1290.78, 10.00, 10.00, null, 31.3],
        ['2008', 803004, 186057, 23.17, 1232, 11751, -13506, 387136, 135583, -10.5, 0.9, 2.9, 31.3, -127.90, 1149.25, 10.00, 5.00, null, null],
        ['2009', 820030, 194801, 23.76, 10509, 19612, 9323, 403180, 141642, 7.5, 2.8, 5.0, 31.7, 89.60, 1237.96, 10.00, 10.00, null, 22.3],
        ['2010', 901010, 217141, 24.1, 26339, 34435, 16211, 403399, 155947, 12.1, 8.0, 8.5, 35.0, 157.76, 1376.18, 10.00, 10.00, 5.00, 15.8],
        ['2011', 759025, 185215, 24.4, 9286, 16384, 3697, 362653, 144229, 2.6, 2.1, 4.3, 39.5, 35.87, 1384.69, 10.00, 10.00, null, 55.8],
        ['2012', 685145, 173617, 25.34, -2476, 1476, -2640, 378087, 138489, -1.9, -0.4, 0.4, 36.6, -25.80, 1361.19, 10.00, 10.00, null, null],
        ['2013', 766699, 202500, 26.41, 13720, 14883, 5149, 385799, 146756, 3.6, 3.3, 3.9, 38.0, 48.42, 1325.29, 10.00, 12.00, null, 45.4],
        ['2014', 691216, 190360, 27.54, 10745, 11118, 4929, 367338, 145086, 3.4, 2.5, 3.0, 39.5, 45.77, 1389.43, 10.00, 10.00, null, 43.7],
        ['2015', 692087, 196076, 28.33, 17050, 17275, 6022, 360312, 141986, 4.2, 4.1, 4.7, 39.4, 60.04, 1437.65, 10.00, 12.00, null, 36.6],
        ['2016', 674426, 193034, 28.62, 15273, 16005, 13118, 368177, 151512, 8.9, 4.0, 4.4, 41.2, 133.04, 1558.86, 11.00, 15.00, null, 19.5],
        ['2017', 686284, 198165, 28.88, 15378, 16167, 8944, 369448, 169005, 5.6, 4.2, 4.4, 45.7, 90.84, 1535.84, 13.00, 15.00, null, 30.8],
        ['2018', 718638, 209820, 29.2, 17842, 18889, 11642, 355947, 178172, 6.7, 5.0, 5.2, 50.1, 105.34, 1601.53, 14.00, 18.00, null, 30.4],
        ['2019', 733575, 210605, 28.71, 12284, 13365, 10977, 350024, 180400, 6.1, 4.2, 3.8, 51.5, 101.33, 1685.50, 18.00, 16.00, null, 33.6],
        ['2020', 768113, 225638, 29.38, 26785, 27811, 16633, 386425, 193841, 8.9, 7.1, 7.6, 50.2, 155.34, 1809.68, 20.00, 21.00, 5.00, 29.6],
        ['2021', 713768, 209681, 29.38, 18796, 21589, 13109, 377970, 199480, 6.7, 4.9, 5.6, 52.8, 125.41, 1950.13, 22.00, 22.00, null, 35.1],
        ['2022', 720584, 210876, 29.26, 19186, 19248, 11393, 369365, 201656, 5.7, 5.2, 5.2, 54.6, 112.36, 2048.30, 22.00, 22.00, null, 39.2],
        ['2023', 721085, 209586, 29.07, 16929, 17339, 9021, 431694, 214921, 4.3, 3.5, 4.3, 49.7, 90.07, 2042.40, 22.00, 23.00, null, 50.0]
      ];


    function drawChart() {

      let select = document.querySelector("#pulldown");
      var val = select.selectedIndex;

      if (val == 0) { var array = array1; }
      else if (val == 1) { var array = array2; }
      else if (val == 2) { var array = array3; }
      else if (val == 3) { var array = array4; }

      var dataA = google.visualization.arrayToDataTable(array);

      //-------------------------
      //　共通オプションの設定
      //-------------------------
      var commonOptions = {
        titleTextStyle: { fontSize: 20 },
        legend: { position: 'top', alignment: 'end' },
        tooltip: { format: '#,##0.00' },
        interpolateNulls: false,             //null値を表示しない
        chartArea: { left: 80, right: 80, top: 50 },
        animation: {
          duration: 2000,
          easing: 'out',
          startup: true
        }
      };

      //-------------------------------------
      //１． 売上高・売上総利益・売上総利益率
      //-------------------------------------
      var chart1Data = google.visualization.data.group(dataA, [0, 1, 2, 3]);

      var optionsChart1 = {
        title: '売上高・売上総利益・売上総利益率（百万円　％）',
        colors: ['#B4DCFF', '#A0C8FF', '#ff3300'],
        seriesType: 'bars',
        series: { 2: { type: "line", targetAxisIndex: 1, pointSize: 8 } },
        bar: { groupWidth: '80%' },
        //isStacked: true,
        vAxes: {
          0: {
            textPosition: 'true',//Y軸ラベルの表示切替
            viewWindow: { min: 0, max: 1000000 }
          },
          1: {
            textPosition: 'true',
            viewWindow: { min: 15, max: 35 },
            format: '##％'
          }
        },
        vAxis: {
          gridlines: { color: '', },
          minValue: 0,
          maxValue: 35
        }
      };

      //小数点2位揃え
      var formatter = new google.visualization.NumberFormat({ pattern: '#,##0.00' });
      formatter.format(chart1Data, 3);

      var chartOptions1 = Object.assign({}, commonOptions, optionsChart1);//共通オプションと個別オプションを統合
      var chart1 = new google.visualization.ComboChart(document.getElementById('chart1_div'));
      chart1.draw(chart1Data, chartOptions1);//描画

      //-------------------------------------
      //２． 営業利益・経常利益・当期利益
      //-------------------------------------
      var chart2Data = google.visualization.data.group(dataA, [0, 4, 5, 6]);

      var optionsChart2 = {
        title: '営業利益・経常利益・当期利益（百万円）',
        colors: ['#B4DCFF', '#A0C8FF', '#8CB4FF'],
        bar: { groupWidth: '80%' },
        vAxis: {
          format: 'decimal',
          gridlines: { color: '', }
        },
      };

      var chartOptions2 = Object.assign({}, commonOptions, optionsChart2);
      var chart2 = new google.visualization.ColumnChart(document.getElementById('chart2_div'));
      chart2.draw(chart2Data, chartOptions2);

      //-------------------------------------
      //３． 財務状況(総資産、純資産、ROE、ROIC、ROA）
      //-------------------------------------
      var chart3Data = google.visualization.data.group(dataA, [0, 7, 8, 9, 10, 11]);

      var optionsChart3 = {
        title: '財務状況（百万円　％）',
        colors: [
          '#B4DCFF',//総資産
          '#A0C8FF',//純資産
          '#ff3300',//ROE
          '#33cc99',//ROIC
          '#0000cc' //ROA
        ],
        seriesType: 'bars',
        series: {
          2: { type: "line", targetAxisIndex: 1, pointSize: 8 },
          3: { type: "line", targetAxisIndex: 1, pointSize: 8 },
          4: { type: "line", targetAxisIndex: 1, pointSize: 8 }
        },
        vAxes: {
          0: {
            textPosition: 'true',//Y軸ラベルの表示切替
            viewWindow: { min: 0, max: 500000 }
          },
          1: {
            textPosition: 'true',
            viewWindow: { min: -11, max: 15 },
            format: '##％'
          }
        },
        vAxis: {
          format: 'decimal',
          gridlines: { color: '', }
        }
      };

      //小数点2位揃え
      var formatter = new google.visualization.NumberFormat({ pattern: '#,##0.0' });
      formatter.format(chart3Data, 3);
      formatter.format(chart3Data, 4);
      formatter.format(chart3Data, 5);


      var chartOptions3 = Object.assign({}, commonOptions, optionsChart3);
      var chart3 = new google.visualization.ColumnChart(document.getElementById('chart3_div'));
      chart3.draw(chart3Data, chartOptions3);

      //-------------------------------------
      //４．一株あたりデータ
      //-------------------------------------
      var chart4Data = google.visualization.data.group(dataA, [0, 12, 13, 14]);

      var optionsChart4 = {
        title: '一株あたりデータ（円　％）',
        colors: ['#ff3300', '#B4DCFF', '#A0C8FF'],
        seriesType: 'bars',
        series: { 0: { type: "line", targetAxisIndex: 1, pointSize: 8 } },
        vAxes: {
          0: {
            textPosition: 'true',//Y軸ラベルの表示切替
            viewWindow: { min: -130, max: 2500 }
          },
          1: {
            textPosition: 'true',
            viewWindow: { min: 10, max: 70 },
            format: '##％'
          }
        },
        vAxis: {
          format: 'decimal',
          gridlines: { color: '', }
        }
      };

      var formatter = new google.visualization.NumberFormat({ pattern: '#,##0.00' });
      formatter.format(chart4Data, 3);

      var chartOptions4 = Object.assign({}, commonOptions, optionsChart4);
      var chart4 = new google.visualization.ColumnChart(document.getElementById('chart4_div'));
      chart4.draw(chart4Data, chartOptions4);

      //-------------------------------------
      //５．配当推移
      //-------------------------------------
      var chart5Data = google.visualization.data.group(dataA, [0, 15, 16, 17, 18]);

      var optionsChart5 = {
        title: '配当推移（円　％）',
        colors: [
          '#99ccff',//中間配当
          '#B4DCFF',//期末配当
          '#ffcccc',//記念配当
          '#ff6633' //配当性向
        ],
        seriesType: 'bars',
        series: { 3: { type: "line", targetAxisIndex: 1, pointSize: 8, lineDashStyle: [1, 2] } },
        isStacked: true,
        vAxes: {
          0: {
            textPosition: 'true',//Y軸ラベルの表示切替
            viewWindow: { min: 0, max: 50 }
          },
          1: {
            textPosition: 'true',
            viewWindow: { min: 10, max: 70 },
            format: '##％'
          }
        },
        vAxis: {
          format: 'decimal',
          gridlines: { color: '', }
        }
      };

      var formatter = new google.visualization.NumberFormat({ pattern: '#,##0.00' });
      formatter.format(chart5Data, 3);


      if (val == 3) {

        var chartOptions5 = Object.assign({}, commonOptions, optionsChart5);
        var chart5 = new google.visualization.ColumnChart(document.getElementById('chart5_div'));
        chart5.draw(chart5Data, chartOptions5);

      } else {



      }

      //スマホ等サイズ対応
      //-------------------------------------

      window.onresize = function () {
        drawChart();
      }
    }

    //データをエクセルで出力
    //-------------------------------------

    var ddd = array1.concat(array2, array3, array4);

    function sheet_to_workbook(sheet/*:Worksheet*/, opts)/*:Workbook*/ {
      var n = opts && opts.sheet ? opts.sheet : "Sheet1";
      var sheets = {}; sheets[n] = sheet;
      return { SheetNames: [n], Sheets: sheets };
    }

    function aoa_to_workbook(data/*:Array<Array<any> >*/, opts)/*:Workbook*/ {
      return sheet_to_workbook(XLSX.utils.aoa_to_sheet(data, opts), opts);
    }

    function s2ab(s) {
      var buf = new ArrayBuffer(s.length);
      var view = new Uint8Array(buf);
      for (var i = 0; i != s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;
      return buf;
    }

    function func1() {
      var write_opts = {
        type: 'binary'
      };
      var wb = aoa_to_workbook(ddd);
      var wb_out = XLSX.write(wb, write_opts);
      var blob = new Blob([s2ab(wb_out)], { type: 'application/octet-stream' });
      saveAs(blob, 'myExcelFile.xlsx');
    }

  </script>
</p>

<div style="text-align: right;"><input id="xlsx" onclick="func1()" type="button" value="Excelファイル出力" /></div>

<h4>&nbsp;</h4>

<div id="chart1_div" style="height: 500px;width:100%;">&nbsp;</div>

<div id="chart2_div" style="height: 500px;width:100%;">&nbsp;</div>

<div id="chart3_div" style="height: 500px;width:100%;">&nbsp;</div>

<div id="chart4_div" style="height: 500px;width:100%;">&nbsp;</div>

<div id="chart5_div" style="height: 500px;width:100%;">&nbsp;</div>